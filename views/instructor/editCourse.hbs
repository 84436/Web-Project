{{#section "css"}}
{{!-- ----------- --}}
{{!-- Import ZONE --}}
{{!-- ----------- --}}
<!-- Filepond stylesheet -->
<link href="https://unpkg.com/filepond/dist/filepond.css" rel="stylesheet">
<link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
<link href="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css" rel="stylesheet">
{{/section}}

{{> navbar-instructor-alt}}
<!-- Our Dashboard -->
<div class="dashboard_main_content" style="padding: 32px; padding-top: 64px;">
    <div class="container-fluid">
        <div class="main_content_container" style="padding-top: 60px;">
            <div class="row">
                <div class="col-lg-12">
                    <div class="dashboard_navigationbar dn db-1199">
                        <div class="dropdown">
                            <button onclick="myFunction()" class="dropbtn"><i class="fa fa-bars pr10"></i> Dashboard
                                Navigation</button>
                            <ul id="myDropdown" class="dropdown-content">
                                <li><a href="page-dashboard.html"><span class="flaticon-puzzle-1"></span> Dashboard</a>
                                </li>
                                <li><a href="page-my-courses.html"><span class="flaticon-online-learning"></span> My
                                        Courses</a></li>
                                <li class="active"><a href="page-my-order.html"><span
                                            class="flaticon-shopping-bag-1"></span> Order</a></li>
                                <li><a href="page-my-message.html"><span class="flaticon-speech-bubble"></span>
                                        Messages</a></li>
                                <li><a href="page-my-review.html"><span class="flaticon-rating"></span> Reviews</a></li>
                                <li><a href="page-my-bookmarks.html"><span class="flaticon-like"></span> Bookmarks</a>
                                </li>
                                <li><a href="page-my-listing.html"><span class="flaticon-add-contact"></span> Add
                                        listing</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-sm-12 col-lg-8 col-xl-12">
                    <div class="row">
                        <div class="col-lg-12">
                            <div class="dashboard_navigationbar dn db-1199">
                                <div class="dropdown">
                                    <button onclick="myFunction()" class="dropbtn"><i class="fa fa-bars pr10"></i>
                                        Dashboard Navigation</button>
                                    <ul id="myDropdown" class="dropdown-content">
                                        <li><a href="page-dashboard.html"><span class="flaticon-puzzle-1"></span>
                                                Dashboard</a></li>
                                        <li><a href="page-my-courses.html"><span
                                                    class="flaticon-online-learning"></span> My Courses</a></li>
                                        <li><a href="page-my-order.html"><span class="flaticon-shopping-bag-1"></span>
                                                Order</a></li>
                                        <li><a href="page-my-message.html"><span class="flaticon-speech-bubble"></span>
                                                Messages</a></li>
                                        <li><a href="page-my-review.html"><span class="flaticon-rating"></span>
                                                Reviews</a></li>
                                        <li><a href="page-my-bookmarks.html"><span class="flaticon-like"></span>
                                                Bookmarks</a></li>
                                        <li><a href="page-my-listing.html"><span class="flaticon-add-contact"></span>
                                                Add listing</a></li>
                                        <li class="active"><a href="page-my-setting.html"><span
                                                    class="flaticon-settings"></span> Settings</a></li>
                                    </ul>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <nav class="breadcrumb_widgets" aria-label="breadcrumb mb30">
                                <h4 class="title float-left">Adding new course</h4>
                            </nav>
                        </div>
                        <div class="col-lg-12">
                            <div class="my_course_content_container">
                                <div class="my_setting_content mb30">
                                    <div class="row my_setting_content_details pb0">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="container-fluid">
                                                    <div id="main-information-input-group" class="form-group">
                                                        <label id="main-label" for="main-information-cover-img">
                                                            Course Image
                                                        </label>
                                                        <input name="coverImage" type="file"
                                                            id="main-information-cover-img">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="my_profile_setting_input form-group">
                                                        <label for="formGroupExampleInput1">Course name</label>
                                                        <input type="text" class="form-control" id="name"
                                                            placeholder="">
                                                    </div>

                                                </div>
                                            </div>
                                        </div>
                                        <!-- INSERT CATEGORY DROPDOWN -->
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="my_profile_setting_input form-group">
                                                        <label for="formGroupExampleInput1">Category </label>
                                                        <select id="main-category" class="selectpicker show-tick">
                                                            <option disabled>-- Choose a category --</option>
                                                            {{#each catRaw}}
                                                            <option value="{{this._id}}">
                                                                {{this.major}} > {{this.minor}}
                                                            </option>
                                                            {{/each}}
                                                        </select>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12">
                                            <div class="my_resume_textarea">
                                                <div class="form-group">
                                                    <label for="exampleFormControlTextarea1">Description (short)</label>
                                                    <textarea class="form-control" id="desc-short" rows="3"
                                                        placeholder=""></textarea>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12">
                                            <div class="my_resume_textarea">
                                                <div class="form-group">
                                                    <label for="exampleFormControlTextarea1">Description (long)</label>
                                                    <div id="editor" name="description"></div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="my_profile_setting_input form-group">
                                                        <label for="formGroupExampleInput1">Price</label>
                                                        <input type="text" class="form-control" id="price"
                                                            onkeypress="return /[0-9.]/i.test(event.key)"
                                                            placeholder="0.00">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="my_profile_setting_input form-group">
                                                        <label for="formGroupExampleInput1">Discount (0.x-1)</label>
                                                        <input type="text" class="form-control" id="discount"
                                                            onkeypress="return /[0-9.]/i.test(event.key)"
                                                            placeholder="0.00">
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row my_setting_content_details">
                                        <div class="col-lg-12">
                                            <button type="submit" class="my_setting_savechange_btn btn btn-thm" onclick="AddNewCourseSubmit()">Save
                                                <span class="flaticon-right-arrow-1 ml15"></span></button>
                                            <span id="save-error" class="text-danger" style="margin-left: 20px;"></span>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-lg-12">
                            <nav class="breadcrumb_widgets" aria-label="breadcrumb mb30">
                                <h4 class="title float-left">Add chapter</h4>
                            </nav>
                        </div>
                        <div class="col-lg-12">
                            <div class="my_course_content_container">
                                <div class="my_setting_content mb30">
                                    <div class="row my_setting_content_details pb0">
                                        <div class="col-lg-12">
                                            <div class="row">
                                                <div class="container-fluid">
                                                    <div id="main-information-input-group" class="form-group">
                                                        <label id="main-label" for="main-information-cover-img">
                                                            Course Image
                                                        </label>
                                                        <input name="coverImage" type="file"
                                                            id="main-information-cover-img">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="my_profile_setting_input form-group">
                                                        <label for="formGroupExampleInput1">Course name</label>
                                                        <input type="text" class="form-control" id="name"
                                                            placeholder="">
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="row my_setting_content_details">
                                                    <div class="col-lg-12">
                                                        <button type="submit"
                                                            class="my_setting_savechange_btn btn btn-thm"
                                                            onclick="saveChange()">
                                                            <i class="fa fa-plus"></i>
                                                            Add
                                                        </button>
                                                        <span id="save-error" class="text-danger"
                                                            style="margin-left: 20px;"></span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{{> footer}}
{{#section "js2"}}
{{!-- ----------- --}}
{{!-- Import ZONE --}}
{{!-- ----------- --}}
<!-- Load FilePond library -->
<script src="https://unpkg.com/filepond-plugin-file-validate-size/dist/filepond-plugin-file-validate-size.js"></script>
<script src="https://unpkg.com/filepond-plugin-file-validate-type/dist/filepond-plugin-file-validate-type.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-validate-size/dist/filepond-plugin-image-validate-size.js">
</script>
<script src="https://unpkg.com/filepond-plugin-file-rename/dist/filepond-plugin-file-rename.js"></script>
<script src="https://unpkg.com/filepond-plugin-image-preview/dist/filepond-plugin-image-preview.js"></script>
<script src="https://unpkg.com/filepond/dist/filepond.js"></script>
<!-- Include the Quill library -->
<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
<!-- Load sweet alert and jQuery ajax-->
<script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

<!-- Turn all file input elements into ponds -->
<script>
    // Register the plugin with FilePond
    FilePond.registerPlugin(
        FilePondPluginImagePreview,
        FilePondPluginFileValidateSize,
        FilePondPluginFileValidateType,
        FilePondPluginImageValidateSize,
        FilePondPluginFileRename
    );


    FilePond.setOptions({
        server: {
            process: (fieldName, file, metadata, load, error, progress, abort, transfer, options) => {

                console.log(file);
                console.log(file.name);

                // fieldName is the name of the input field
                // file is the actual file object to send
                var func = (fieldName, file, callback) => {
                    console.log("Send Data");
                    const formData = new FormData();
                    const request = new XMLHttpRequest();
                    formData.append(fieldName, file, file.name);
                    request.open('POST', '/instructor/courses/add/uploadImage');
                    request.upload.onprogress = (e) => {
                        console.log("On Progress");
                        progress(e.lengthComputable, e.loaded, e.total);
                    };
                    request.upload.onloadend = (e) => {
                        console.log("On Load End");
                        callback();
                    };
                    request.onload = function () {
                        console.log("On load");
                        if (request.status >= 200 && request.status < 300) {
                            // the load method accepts either a string (id) or an object
                            load(request.responseText);
                        }
                        else {
                            error('oh no');
                        }
                    };
                    request.send(formData);

                };
                const data = {
                    callbackSubmit: func,
                    fieldName: fieldName,
                    file: file
                }
                pondImageCover = data;
                return {
                    abort: () => {
                        console.log("Cancel");
                        abort();
                        return pondImageCover = null;
                    }
                };
            }

        }
    });

    // Get a reference to the file input element
    const inputElementPondCoverImage = document.querySelector('input[type="file"]#main-information-cover-img');

    // Create the FilePond instance
    const pondCoverImage = FilePond.create(inputElementPondCoverImage, {
        maxFileSize: '10MB',
        imagePreviewHeight: 500,
        acceptedFileTypes: ['image/*'],
        fileRenameFunction: (file) => {
            return `cover${file.extension}`;
        },
        imageValidateSizeMinWidth: 600,
        imageValidateSizeMinHeight: 400
    });

    // Initialize Quill editor
    var toolbarOptions = [
        ['bold', 'italic', 'underline', 'strike'], // toggled buttons
        ['blockquote', 'code-block'],
        [{
            'header': 1
        }, {
            'header': 2
        }], // custom button values
        [{
            'list': 'ordered'
        }, {
            'list': 'bullet'
        }],
        [{
            'script': 'sub'
        }, {
            'script': 'super'
        }], // superscript/subscript
        [{
            'indent': '-1'
        }, {
            'indent': '+1'
        }], // outdent/indent
        [{
            'direction': 'rtl'
        }], // text direction
        [{
            'size': ['small', false, 'large', 'huge']
        }], // custom dropdown
        [{
            'header': [1, 2, 3, 4, 5, 6, false]
        }],
        [{
            'color': []
        }, {
            'background': []
        }], // dropdown with defaults from theme
        [{
            'font': []
        }],
        [{
            'align': []
        }],
        ['clean'] // remove formatting button
    ];
    var quill = new Quill('#editor', {
        modules: {
            toolbar: toolbarOptions
        },
        theme: 'snow'
    });
</script>
<script>

</script>
{{/section}}